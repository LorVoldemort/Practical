create table info
(
	rollno number ,
	name varchar2(30),
	branch varchar2(30)
);

create table info1
(
	rollno number ,
	name varchar2(30),
	branch varchar2(30)
);

insert into info values (1, 'abhinav', 'computer');
insert into info values (2, 'raj', 'mech');
insert into info values (3, 'sai', 'prod');
insert into info values (4, 'pravin', 'it');

insert into info1 values (5, 'rahul', 'it');
insert into info1 values (2, 'raj', 'mech');
insert into info1 values (6, 'ramesh', 'prod');
insert into info1 values (7, 'mahesh', 'civil');

declare
	rn info.rollno%type;
	nm info.name%type;
	br info.branch%type;
	
	cursor c_info is

		select * from info 
		minus
		select * from info1;
begin
	open c_info;

	loop

		fetch c_info into rn,nm,br;
		exit when c_info%notfound;

		insert into info1 values(rn,nm,br);
		dbms_output.put_line(rn ||' '|| nm||' '||br||' ');
	end loop;

	close c_info;
end;
/
	

	





CREATE TABLE Library (
    Book_ID      NUMBER(5) PRIMARY KEY,
    Book_Name    VARCHAR2(100),
    Author_Name  VARCHAR2(50),
    Price        NUMBER(8,2)
);


CREATE TABLE Library_Audit (
    Audit_ID     NUMBER(5) PRIMARY KEY,
    Book_ID      NUMBER(5),
    Book_Name    VARCHAR2(100),
    Author_Name  VARCHAR2(50),
    Price        NUMBER(8,2),
    Operation    VARCHAR2(10),      
    Operation_By VARCHAR2(30),    
    Operation_On DATE DEFAULT SYSDATE
);



INSERT INTO Library VALUES (1, 'DBMS Concepts', 'Korth', 550);
INSERT INTO Library VALUES (2, 'Let Us C', 'Yashwant Kanetkar', 300);
INSERT INTO Library VALUES (3, 'Artificial Intelligence', 'Russell', 700);


CREATE SEQUENCE seq_audit_id
START WITH 1
INCREMENT BY 1;


CREATE OR REPLACE TRIGGER trg_Library_Audit
AFTER UPDATE OR DELETE
ON Library
FOR EACH ROW
BEGIN
    IF UPDATING THEN
        INSERT INTO Library_Audit (Audit_ID, Book_ID, Book_Name, Author_Name, Price, Operation, Operation_By)
        VALUES (seq_audit_id.NEXTVAL, :OLD.Book_ID, :OLD.Book_Name, :OLD.Author_Name, :OLD.Price, 'UPDATE', 'USER');
    ELSIF DELETING THEN
        INSERT INTO Library_Audit (Audit_ID, Book_ID, Book_Name, Author_Name, Price, Operation, Operation_By)
        VALUES (seq_audit_id.NEXTVAL, :OLD.Book_ID, :OLD.Book_Name, :OLD.Author_Name, :OLD.Price, 'DELETE', 'USER');
    END IF;
END;
/


//for output

UPDATE Library
SET Price = 600
WHERE Book_ID = 1;

DELETE FROM Library
WHERE Book_ID = 2;



